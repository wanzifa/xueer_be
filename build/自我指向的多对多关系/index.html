<!DOCTYPE HTML>
<html>
<head>
<title>è‡ªæˆ‘æŒ‡å‘çš„å¤šå¯¹å¤šå…³ç³»</title>
<!-- Bootstrap -->
<link href="../static/bootstrap.min.css" rel='stylesheet' type='text/css' />
<link href="../static/bootstrap.css" rel='stylesheet' type='text/css' />
<meta name="viewport" content="width=device-width, initial-scale=1">
<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
 <!--[if lt IE 9]>
     <script src="../static/html5shiv.js"></script>
     <script src="../static/respond.min.js"></script>
<![endif]-->

<link href="../static/style.css" rel="stylesheet" type="text/css" media="all" />
<!-- start plugins -->
<script type="text/javascript" src="../static/jquery.min.js"></script>
	<script>
		$(function() {
			var pull 		= $('#pull');
				menu 		= $('nav ul');
				menuHeight	= menu.height();
			$(pull).on('click', function(e) {
				e.preventDefault();
				menu.slideToggle();
			});
			$(window).resize(function(){
        		var w = $(window).width();
        		if(w > 320 && menu.is(':hidden')) {
        			menu.removeAttr('style');
        		}
    		});
		});
	</script>
<!----font-Awesome----->
   	<link rel="stylesheet" href="../static/font-awesome.min.css">
<!----font-Awesome----->
</head>
<body>
<div class="header_bg" id="home"><!-- start header -->
<div class="container">
	<div class="row header text-center specials">
		<div class="h_logo">
			<a href="index.html"><img src="../static/logo.png" alt="" class="responsive"/></a>
		</div>
		<nav class="top-nav">
			<ul class="top-nav nav_list">
			    <li class="page-scroll"><a href="/blog/"><u>ğŸºï¸blogâ¤ï¸â¤ğŸºï¸ï¸</u></a></li>
			</ul>
			<a href="#" id="pull"><img src="images/nav-icon.png" title="menu" /></a>
		</nav>
		<div class="clearfix"></div>
	</div>
</div>
</div>
<div class="blog"><!-- start main -->
	<div class="container">
		<div class="main row">
			<h2 class="style">è‡ªæˆ‘æŒ‡å‘çš„å¤šå¯¹å¤šå…³ç³»</h2>
			<div class="details row">
				<div class="col-md-6">
					<img src="images/det_pic.jpg" alt="" class="img-responsive"/>
				</div>

                <p class="para"><p>è‡ªæˆ‘æŒ‡å‘çš„å¤šå¯¹å¤šå…³ç³»</p>
<hr />
<p>å†™è¿™ç¯‡æ–‡ç« æ˜¯å› ä¸ºå‰æ®µæ—¶é—´æˆ‘å¯¹æ•°æ®åº“è¿™ä¸ªé—®é¢˜ä¸å¤ªç†è§£ï¼Œåæ¥æŠŠæˆ¿ç¥–åä¹Ÿå‘è¿›æ¥äº†ï¼Œç»¼åˆäº†ä¸€äº›ä¿¡æ¯ä¹‹åç»ˆäºå¤§æ¦‚çŸ¥é“æ˜¯æ€ä¹ˆå›äº‹äº†ï¼Œä»Šå¤©è¯•è¯•ç®€åŒ–ä¸€ä¸‹,é—®é¢˜ã€‚
é¦–å…ˆæ¥çœ‹è¿™ä¸¤æ®µä»£ç ï¼š</p>
<div class="codehilite"><pre><span class="mf">1.</span><span class="n">class</span> <span class="n">Follow</span><span class="p">(</span><span class="n">db</span><span class="p">.</span><span class="n">Model</span><span class="p">)</span><span class="o">:</span>
      <span class="n">__tablename__</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">follows</span><span class="err">&#39;</span>
      <span class="n">follower_id</span> <span class="o">=</span> <span class="n">db</span><span class="p">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="p">.</span><span class="n">Integer</span><span class="p">,</span>       <span class="n">db</span><span class="p">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="err">&#39;</span><span class="n">users</span><span class="p">.</span><span class="n">id</span><span class="err">&#39;</span><span class="p">),</span>
                        <span class="n">primary_key</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>
      <span class="n">followed_id</span> <span class="o">=</span> <span class="n">db</span><span class="p">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="p">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">db</span><span class="p">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="err">&#39;</span><span class="n">users</span><span class="p">.</span><span class="n">id</span><span class="err">&#39;</span><span class="p">),</span>
                        <span class="n">primary_key</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>
      <span class="n">timestamp</span> <span class="o">=</span> <span class="n">db</span><span class="p">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="p">.</span><span class="n">DateTime</span><span class="p">,</span> <span class="k">default</span><span class="o">=</span><span class="n">datetime</span><span class="p">.</span><span class="n">utcnow</span><span class="p">)</span>

<span class="mf">2.</span><span class="n">class</span> <span class="n">User</span><span class="p">(</span><span class="n">UserMixin</span><span class="p">,</span> <span class="n">db</span><span class="p">.</span><span class="n">Model</span><span class="p">)</span><span class="o">:</span>
      <span class="n">__tablename__</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">users</span><span class="err">&#39;</span>
      <span class="err">ã€‚ã€‚ã€‚ï¼ˆçœç•¥ä¸€å †å±æ€§çš„å®šä¹‰ï¼‰</span>
      <span class="n">followed</span> <span class="o">=</span> <span class="n">db</span><span class="p">.</span><span class="n">relationship</span><span class="p">(</span><span class="err">&#39;</span><span class="n">Follow</span><span class="err">&#39;</span><span class="p">,</span>
                           <span class="n">foreign_keys</span><span class="o">=</span><span class="p">[</span><span class="n">Follow</span><span class="p">.</span><span class="n">follower_id</span><span class="p">],</span>
                           <span class="n">backref</span><span class="o">=</span><span class="n">db</span><span class="p">.</span><span class="n">backref</span><span class="p">(</span><span class="err">&#39;</span><span class="n">follower</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">lazy</span><span class="o">=</span><span class="err">&#39;</span><span class="n">joined</span><span class="err">&#39;</span><span class="p">),</span>
                           <span class="n">lazy</span><span class="o">=</span><span class="err">&#39;</span><span class="n">dynamic</span><span class="err">&#39;</span><span class="p">,</span>
                           <span class="n">cascade</span><span class="o">=</span><span class="err">&#39;</span><span class="n">all</span><span class="p">,</span> <span class="n">delete</span><span class="o">-</span><span class="n">orphan</span><span class="err">&#39;</span><span class="p">)</span>
      <span class="n">followers</span> <span class="o">=</span> <span class="n">db</span><span class="p">.</span><span class="n">relationship</span><span class="p">(</span><span class="err">&#39;</span><span class="n">Follow</span><span class="err">&#39;</span><span class="p">,</span>
                            <span class="n">foreign_keys</span><span class="o">=</span><span class="p">[</span><span class="n">Follow</span><span class="p">.</span><span class="n">followed_id</span><span class="p">],</span>
                            <span class="n">backref</span><span class="o">=</span><span class="n">db</span><span class="p">.</span><span class="n">backref</span><span class="p">(</span><span class="err">&#39;</span><span class="n">followed</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">lazy</span><span class="o">=</span><span class="err">&#39;</span><span class="n">joined</span><span class="err">&#39;</span><span class="p">),</span>
                            <span class="n">lazy</span><span class="o">=</span><span class="err">&#39;</span><span class="n">dynamic</span><span class="err">&#39;</span><span class="p">,</span>
                            <span class="n">cascade</span><span class="o">=</span><span class="err">&#39;</span><span class="n">all</span><span class="p">,</span> <span class="n">delete</span><span class="o">-</span><span class="n">orphan</span><span class="err">&#39;</span><span class="p">)</span>
</pre></div>


<p>ä»¥ä¸Šä¾¿æ˜¯ã€Šflask webå¼€å‘ã€‹è¿™æœ¬ä¹¦é‡Œé¢å‡ºç°çš„è‡ªå¼•ç”¨å¤šå¯¹å¤šå…³ç³»ã€‚
é¦–å…ˆçœ‹è¿™ä¸ªfollowsè¡¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªå…³è”è¡¨ï¼Œfollowr_idå’Œfollowed_idåˆ†åˆ«è¡¨ç¤ºå…³æ³¨è€…å’Œè¢«å…³æ³¨è€…ï¼Œè¿™ä¸¤æ å‡å¼•ç”¨è‡ªä¸‹é¢çš„usersè¡¨ã€‚
é€ä¸ªåˆ†æusersè¡¨ä¸­relationshipå‡½æ•°çš„å‚æ•°è®¾ç½®ï¼š
(é¦–å…ˆæˆ‘ä»¬æ˜ç¡®å¤šå¯¹å¤šå…³ç³»å®é™…ä¸Šå°±æ˜¯è®¸å¤šä¸ªä¸€å¯¹å¤šå…³ç³»å“ˆï¼‰
1.
foreign_keysè¿™ä¸ªå±æ€§è®¾ç½®åœ¨ä¸€å¯¹å¤šçš„â€œå¤šâ€è¿™ä¸€ä¾§ï¼Œä»â€œ1â€çš„ä¸€ä¾§å¼•ç”¨æ•°æ®ã€‚åœ¨è¿™é‡Œï¼Œè¢«å¼•ç”¨çš„æ˜¯followersè¡¨ä¸­çš„follower_idå±æ€§ã€‚
2.
backrefå±æ€§æ˜¯åœ¨å’Œå®ƒå»ºç«‹å¤šå¯¹å¤šå…³ç³»çš„å¦ä¸€ä¸ªè¡¨ä¸­å¼€è¾Ÿä¸€ä¸ªåä¸ºâ€œfollowerâ€çš„æ–°å±æ€§ï¼Œè¿™æ ·åœ¨follwersè¡¨ä¸­è°ƒç”¨followerå±æ€§æ—¶ï¼Œå°±ä¼šè¿”å›å¯¹åº”çš„Userå®ä¾‹äº†ã€‚<strong>ä¹‹æ‰€ä»¥usersä¸­æ˜æ˜æ˜¯è¢«å…³æ³¨è€…ï¼Œåˆ°äº†é‚£è¾¹å´æˆäº†å…³æ³¨è€…ï¼Œæ˜¯å› ä¸ºusersé‡Œé¢çš„â€œfollowedâ€œä»£è¡¨çš„è¿™ä¸ªå…³ç³»ï¼Œå®ƒæŸ¥è¯¢çš„æ˜¯ç”¨æˆ·å…³æ³¨çš„å¯¹è±¡ï¼Œè€Œfollowersè¡¨é‡Œé¢çš„è¿™ä¸ªâ€œfollower_idâ€å®ƒå¯¹åº”çš„æ°å¥½æ˜¯å½“ç”¨æˆ·ä½œä¸ºä¸€ä¸ªå…³æ³¨è€…çš„æ—¶å€™å…³æ³¨çš„å¯¹è±¡çš„id</strong>ã€‚è¯•æƒ³ï¼Œå½“æˆ‘ä»¬ä½œä¸ºè¢«å…³æ³¨è€…çš„æ—¶å€™ï¼Œæˆ‘ä»¬è‚¯å®šå…³å¿ƒçš„æ˜¯æˆ‘ä»¬çš„followerséƒ½æ˜¯è°ï¼Œæ‰€ä»¥è¿™ä¸ªé—®é¢˜å°±è§£å†³äº†ã€‚æ­£å› ä¸ºæ­¤ï¼Œ<strong>æ‰€ä»¥æˆ‘ä»¬çš„followedå±æ€§ï¼Œå®ƒçš„å¤–é”®æ˜¯followerï¼Œè¢«å¼•ç”¨çš„æ—¶å€™ä¹Ÿæ˜¯å½“ä½œè¢«followerè¢«å¼•å»è¾…åŠ©è¡¨é‡Œé¢ã€‚</strong>åŒæ ·çš„é“ç†ï¼Œç¬¬äºŒä¸ªrelationshipä¹Ÿæ˜¯å¦‚æ­¤ã€‚
3.
lazyå‚æ•°åœ¨æœ¬ä¹¦ä¸­é¦–æ¬¡åˆ¶å®šäº†joinedï¼Œè¿™ä¸ªæ¨¡å¼å¯ä»¥å®ç°ç«‹åˆ»ä»<strong>è”ç»“</strong>æŸ¥è¯¢ä¸­åŠ è½½ç›¸å…³å¯¹è±¡ã€‚
4.
cascadeå‚æ•°é…ç½®åœ¨çˆ¶å¯¹è±¡ä¸Šæ‰§è¡Œçš„æ“ä½œå¯¹ç›¸å…³å¯¹è±¡çš„å½±å“ã€‚deleteï¼orphanå¯ä»¥å®ç°åœ¨åˆ é™¤å¯¹è±¡æ—¶æŠŠå¯¹è±¡è”ç»“çš„æ‰€æœ‰ç›¸å…³å¯¹è±¡çš„å¤–é”®è®¾ä¸ºç©ºå€¼ã€‚
å°±æ˜¯è¿™æ ·å•¦ï¼Œå˜¿å˜¿ï½ï½ï½</p></p>
				<div class="clearfix"></div>
			</div>
		</div>
	</div>
</div><!-- end main -->
<div class="footer1_bg"><!-- start footer1 -->
	<div class="container">
		<div class="row  footer">
			<div class="copy text-center">
				<p class="link"><span>Copyright @bootstrap 2016.wanzifa All rights reserved.</span></p>
				<a href="#home" id="toTop" style="display: block;"><span id="toTopHover" style="opacity: 1;"> </span></a>
			</div>
		</div>
		<script type="text/javascript">
				$(function() {
				  $('a[href*=#]:not([href=#])').click(function() {
				    if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
			
				      var target = $(this.hash);
				      target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
				      if (target.length) {
				        $('html,body').animate({
				          scrollTop: target.offset().top
				        }, 1000);
				        return false;
				      }
				    }
				  });
				});
		</script>
		<!---- start-smoth-scrolling---->		
	</div>
</div>

</body>
</html>